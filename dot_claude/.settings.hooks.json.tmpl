{
  "PreToolUse": [
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/auto-approve.ts"
        },
        {
          "type": "command",
          "command": "awk '{print}' >> '{{ .chezmoi.homeDir }}/.config/claude-companion/logs/hooks.jsonl'"
        }
      ]
    },
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/deny-repository-outside.ts"
        }
      ]
    },
    {
      "matcher": "Bash",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/block-tsx.ts"
        }
      ]
    },
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/deny-node-modules.ts"
        }
      ]
    },
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/block-package-json-tsx.ts"
        }
      ]
    },
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/web-fetch-guardian.ts"
        }
      ]
    }
  ],
  "PostToolUse": [
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/command-logger.ts"
        },
        {
          "type": "command",
          "command": "awk '{print}' >> '{{ .chezmoi.homeDir }}/.config/claude-companion/logs/hooks.jsonl'"
        }
      ]
    },
    {
      "matcher": "(Edit|MultiEdit|Write)",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/auto-format.ts"
        }
      ]
    },
    {
      "matcher": "Bash",
      "hooks": [
        {
          "type": "command",
          "command": "echo \"[$(date '+%F %H:%M:%S')] $USER [$(pwd)]: $(jq -r '.tool_input.command' | sed 's/$/\\\\n/' | tr -d '\\n')\" >> ~/.claude/command_history.log"
        }
      ]
    }
  ],
  "SessionStart": [
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/session.ts"
        },
        {
          "type": "command",
          "command": "awk '{print}' >> '{{ .chezmoi.homeDir }}/.config/claude-companion/logs/hooks.jsonl'"
        }
      ]
    }
  ],
  "Stop": [
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/speak-notification.ts Stop"
        },
        {
          "type": "command",
          "command": "awk '{print}' >> '{{ .chezmoi.homeDir }}/.config/claude-companion/logs/hooks.jsonl'"
        },
        {
          "type": "prompt",
          "prompt": "## Task Review Protocol\n\nClaudeが作業を停止すべきかどうかを評価しています。\n\n### 誠実な自己評価\n\n**利用者の期待を満たしているか、誠実に自己判断してください。**\n- 表面的な完了ではなく、利用者が本当に求めていたことを達成できたか？\n- 自分の作業に不足や改善点はないか、正直に評価する\n- 「とりあえず終わった」ではなく「利用者が満足できる品質か」で判断する\n\n**警告: 勝手な判断による期待値の訂正、ステアリングの解除は許されません。この確認は最後のチャンスです。**\n\n### 評価手順\n\n1. **振り返り**: これまでのセッションで何を行ったか確認\n2. **完了判定**: 元のタスクが完全に達成されたか評価\n3. **不足確認**: 未完了のサブタスク、エラー、改善点がないか確認\n4. **次のアクション決定**:\n   - **完了**: タスクが完全に終了し、利用者の期待を満たした → ok: true\n   - **続行**: 明確な次のステップがある → ok: false, reasonに「次に実行すべき具体的アクション」を書く\n   - **質問**: ユーザー判断が必要 → ok: false, reasonに「AskUserQuestionで確認すべき内容」を書く\n\n### 判断基準\n\n- テストやビルドが失敗している場合 → ok: false\n- 明らかな次のステップがある場合 → ok: false\n- コミットが必要な場合 → ok: false, reason: 「変更をコミットする」\n- ユーザーの元の要求が曖昧または複数解釈可能な場合 → ok: false\n- すべて完了し、品質も十分な場合のみ → ok: true\n\n### 重要: ok: false の場合の動作\n\nok: false を返した場合、Claudeは停止せず続行します。reasonに書いた内容を**実際に実行**してください。提案するだけでなく、アクションを取ること。\n\n必須JSON形式: {\"ok\": true または false, \"reason\": \"判断理由（ok: falseの場合は次に実行すべきアクション）\"}",
          "timeout": 60
        }
      ]
    }
  ],
  "Notification": [
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/speak-notification.ts Notification"
        },
        {
          "type": "command",
          "command": "awk '{print}' >> '{{ .chezmoi.homeDir }}/.config/claude-companion/logs/hooks.jsonl'"
        }
      ]
    }
  ],
  "UserPromptSubmit": [
    {
      "matcher": "",
      "hooks": [
        {
          "type": "command",
          "command": "bun {{ .chezmoi.homeDir }}/.claude/hooks/implementations/user-prompt-logger.ts"
        },
        {
          "type": "command",
          "command": "awk '{print}' >> '{{ .chezmoi.homeDir }}/.config/claude-companion/logs/hooks.jsonl'"
        }
      ]
    }
  ]
}
